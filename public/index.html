<!DOCTYPE html>
<html>
<head>
  <title>Interview Transcript</title>
  <script src="/socket.io/socket.io.js"></script>
  <style>
    .container {
      padding: 20px;
      border: 1px solid #ccc;
      margin: 10px;
      height: 300px; /* Set a fixed height for the container */
      overflow-y: auto; /* Enable a scrollbar when the content exceeds the height */
    }
  </style>
</head>
<body>
  <h1>Interview Transcript</h1>
  <div id="transcript" class="container"></div>

  <h1>Response History</h1>
  <div id="response-history" class="container"></div>

  <script>
    // Connect to the socket.io server
    const socket = io();

    // Function to scroll the specified element to the bottom
    function scrollToBottom(element) {
      element.scrollTop = element.scrollHeight;
    }

    // Function to scroll the specified element to the top
    function scrollToTop(element) {
      element.scrollTop = 0;
    }

    // Update the transcript and response history whenever there is new data from the server
    socket.on('update', (data) => {
      const { messageHistory, response } = data;
      const transcript = document.getElementById('transcript');
      const responseHistory = document.getElementById('response-history');
      transcript.innerHTML = '';

      // Display messageHistory
      messageHistory.forEach(message => {
        const messageElement = document.createElement('p');
        messageElement.textContent = `${message.name}: ${message.content}`;
        transcript.appendChild(messageElement);
      });

      // Scroll the transcript div to the bottom
      scrollToBottom(transcript);

      // Display response from queryGpt
      if (response) {
        const responseElement = document.createElement('p');
        responseElement.textContent = `ChatGPT: ${response}`;
        responseHistory.prepend(responseElement); // Add the response to the top of the response history

        // Scroll the response-history div to the top
        scrollToTop(responseHistory);
      }
    });
  </script>

</body>
</html>
